#!/bin/bash

set -e

source ~/.PairUp/pairup-env
source ~/.PairUp/lib/pairup-util.bash

main() {
  set -x
  SECTION "Admin user setup:"
  mkdir -p ~/.sh
  cp $PAIRUP_ROOT/pairup-env ~/.sh/

  SECTION "Copy known_hosts and config to .ssh/:"
  cp $PAIRUP_ROOT/known_hosts .ssh/known_hosts
  cp $PAIRUP_ROOT/ssh-config .ssh/config

  SECTION "Install ... dotfile management setup:"
  git clone git@github.com:sharpsaw/....git || continue?
  cp $PAIRUP_ROOT/conf... .../conf
  .../... update || continue?
  .../... install || continue?

  SECTION "sudo $PairUp/bin/pairup-install-software"
  log="$PAIRUP_ROOT/install.log" run-section-cmd

  SECTION "sudo $PairUp/bin/pairup-install-cpan"
  log="$PAIRUP_ROOT/cpan.log" run-section-cmd

  SECTION "pairup-install-repos"
  log="$PAIRUP_ROOT/github.log" run-section-cmd

  SECTION "Start the PairUp custom tmux setup:"
  bash -l "$PAIRUP_ROOT/bin/pairup" || true
}

[ "$0" != "$BASH_SOURCE" ] || main "$@"
